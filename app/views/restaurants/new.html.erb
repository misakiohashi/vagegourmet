
<div>
  <h3 class="toppage-content">店舗の登録</h3>
</div>

<div class="row">
  <div class="col-sm-6 offset-sm-3">
      
　  <%= form_with(model: @restaurant, local: true) do |f| %>
    <%= render 'layouts/error_messages', model: f.object %>
    
    <div class="form-group">
    　  <%= f.label :category, 'ジャンル' %>
        <%= f.collection_select :category_id, Category.all, :id, :name,include_blank: "選択して下さい" %>
      </div>
    <div class="form-group">
        <%= f.label :name, '店名' %>
        <%= f.text_field :name, class: 'form-control' %>
    </div>
    <div class="form-group">
        <%= f.label :address, '住所' %>
        <%= f.text_field :address, class: 'form-control' %>
    </div>
    <div class="form-group">
        <%= f.label :tel, '電話番号' %>
        <%= f.text_field :tel, class: 'form-control' %>
    </div>
    <div class="form-group">
        <%= f.label :holiday, '定休日' %>
        <%= f.text_field :holiday, class: 'form-control' %>
    </div>
    <div class="form-group">
    　  <%= f.label :prefecture_id, '都道府県' %>
        <%= f.collection_select :prefecture_id, Prefecture.all, :id, :name,include_blank: "選択して下さい" %>
    </div>
    <div class="form-group">
    　  <%= f.label :area_id, 'エリア' %>
        <%= f.collection_select :area_id, Area.all, :id, :name,include_blank: "選択して下さい" %>
    </div>
    <div class="form-group">
    　  <%= f.label :city_id, '市区町村' %>
        <%= f.collection_select :city_id, City.all, :id, :name,include_blank: "選択して下さい" %>
    </div>
    <div class="form-group">
        <%= f.label :photo,'写真' %>
   　　　<%= f.file_field :photo,accept: 'image/jpeg,image/gif,image/png' %>
      </div>
      
      <script type="text/javascript">
       $('#micropost_picture').bind('change', function() {
       var size_in_megabytes = this.files[0].size/1024/1024;
       if (size_in_megabytes > 5) {
       alert('Maximum file size is 5MB. Please choose a smaller file.');
       }
       });
      </script>

      <%= f.submit '登録', class: 'btn btn-light btn-block' %>
    <% end %>
  </div>
</div>

<h3>店舗一覧</h3>

<ul class="list-unstyled">
    <% @restaurants.each do |restaurant| %>
    <li class="restaurant restaurant-list">
      <div class='restaurant-photo'>
        <%= image_tag restaurant.photo_url if restaurant.photo? %>
      </div>
      <div class='restaurant-summary'>
        <div class="restaurant-category"><%= restaurant.category.name %></div>
        <div class="restaurant-name"><%= restaurant.name %></div>
        <table class="table table-sm">
        
         <tbody>
          <tr>
           <th scope="row">住所</th>
           <td><%= restaurant.address %></td>
          </tr>
          <tr>
           <th scope="row">電話番号</th>
           <td><%= restaurant.tel %></td>
          </tr>
          <tr>
           <th scope="row">定休日</th>
           <td><%= restaurant.holiday %></td>
          </tr>
         </tbody>
        </table>
      </div>
    
      <% if logged_in? && current_user.admin? %>
      <div class='restaurant-btn'>
        <%=link_to "編集",edit_restaurant_path(restaurant),class: 'btn btn-primary btn-sm'%>
        <%=link_to "削除",restaurant,method: :delete,data: { confirm: "You sure?" }, class: 'btn btn-danger btn-sm'%>
      </div>
      <% else %>
      <% end %>
      
      <% if logged_in? %>
        <%= render 'favorites/favorites_button',restaurant: restaurant %>
      <% else %>
    　<% end %>
    
    </li>
    
    <% end %>
</ul>
